<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Nmap Anonymization with Proxychains</title>
	
	<meta name="author" content="Marcos Valle">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/marcosValle">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/_mvalle_">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:marcosvalle@protonmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/1df7ec002d2e576bae0ee492c97e82b8?s=35" class="img-circle" />
				Bugtree
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="//www.gravatar.com/avatar/1df7ec002d2e576bae0ee492c97e82b8?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">Bugtree</a>
    </h3>
</header>


<div id="bio" class="text-center">
	Born to kill bugs. Live by them.
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/marcosValle">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/_mvalle_">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:marcosvalle@protonmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/mvallecyber">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Nmap Anonymization with Proxychains </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   October 
	   17th,
	   
	   2017
	 </span>
	  <div class="article_body">
	  <p>If you work in the infosec industry and never asked yourself this question, please take your time to think. Our objective here is to accomplish a full scan without revealing our real IP to the target.</p>

<h1 id="anonymizing-an-nmap-scan">Anonymizing an nmap scan</h1>

<p>There are multiple ways to accomplish this noble mission. One way would be to execute an <a href="https://nmap.org/book/idlescan.html">Idle Scan</a>, aka <a href="https://nmap.org/book/idlescan.html#idm140153167240176">“the ultimate stealth scan”</a>.</p>

<p>Another idea is just to use proxies or even TOR. Although nmap offers a <code class="highlighter-rouge">--proxy</code> option, <a href="https://nmap.org/book/man-bypass-firewalls-ids.html">it should be noted that</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning: this feature is still under development and has limitations. It is implemented within the nsock library and thus has no effect on the ping, port scanning and OS discovery phases of a scan. Only NSE and version scan benefit from this option so far—other features may disclose your true address. SSL connections are not yet supported, nor is proxy-side DNS resolution (hostnames are always resolved by Nmap).
</code></pre></div></div>

<p>Well, it does not give us much of an option instead of not trusting this feature, does it? Then we present you another solution: proxychains.</p>

<h1 id="what-does-proxychains-do-and-does-not">What does proxychains do (and does not)?</h1>

<p>According to the <a href="https://packages.debian.org/stretch/proxychains">package description</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>proxy chains - redirect connections through proxy servers

Proxy chains force any tcp connection made by any given tcp client to follow through proxy (or proxy chain). It is a kind of proxifier. It acts like sockscap / premeo / eborder driver ( intercepts TCP calls ) 

This version supports SOCKS4, SOCKS5 and HTTP CONNECT proxy servers. Different proxy types can be mixed in the same chain. 
</code></pre></div></div>

<p>Another thing to note in <a href="http://proxychains.sourceforge.net/">here</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Proxychains] Allows TCP and DNS tunneling through proxies. 
</code></pre></div></div>

<p>These are the two protocols we are going to “secure” while using proxychains. Keep in mind that all other protocols might pose a hazard to your anonimity.</p>

<p><strong>Please do check your proxychains version before using it</strong></p>

<p>The latest version of this tool according to the <a href="http://proxychains.sourceforge.net/">SourceForge page</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ProxyChains README 
current version: 3.1
======================
</code></pre></div></div>

<p>However, there is a <a href="https://github.com/haad/proxychains">very well starred repo in GitHub</a> that declares:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ProxyChains ver. 4.2.0 README
</code></pre></div></div>

<p>Now, according to <a href="https://man.cx/proxychains">proxychain’s man page in Debian 9</a> (and Kali therefore):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This version (2.0) supports SOCKS4, SOCKS5 and HTTP CONNECT proxy servers.  Auth-types: socks - "user/pass" , http - "basic".
</code></pre></div></div>

<p>WTF Debian?! To be sure this is just an outdated manpage I checked the package informations:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ apt show proxychains
Package: proxychains
Version: 3.1-7
</code></pre></div></div>
<p>So yeah, it seems ok. The main difference between versions 2 and 3 is the support for DNS requests (which is something really important). Anyway, you should check your version and run some local tests just in case.</p>

<h1 id="nmap-scan-phases">nmap scan phases</h1>

<p>I am assuming here you are familiarized with it. If not, refer to <a href="https://nmap.org/book/nmap-phases.html">this page</a>. All an all, the phases are:</p>

<ol>
  <li>Script pre-scanning</li>
  <li>Target enumeration</li>
  <li>Host discovery (ping scanning)</li>
  <li>Reverse-DNS resolution</li>
  <li>Port scanning</li>
  <li>Version detection</li>
  <li>OS detection</li>
  <li>Traceroute</li>
  <li>Script scanning</li>
  <li>Output</li>
  <li>Script post-scanning</li>
</ol>

<h1 id="what-is-a-ping-to-nmap">What is a ping to nmap?</h1>

<p>First point to make clear is the concept of <em>ping</em> in nmap’s terminology:</p>

<p>So let it be clear once and for all:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ping in daily network lingo is a *program* that uses ICMP to "send ICMP ECHO_REQUEST to network hosts". 
Ping in nmap lingo is any request done in the host discovery phase (**not necessarily ICMP**).
</code></pre></div></div>

<p>Ping scan therefore uses multiple protocols besides ICMP. Keep that in mind.
Now we know the difference between these two guys, we may move on.</p>

<h1 id="proxychains">Proxychains</h1>

<p>Our proxychains config is set to use SOCKS5 protocol in order to tunnel our requests through the TOR network. Our TOR client is listening in port 9050 for that matter. This is the default configuration for proxychains, so lets keep it this way.</p>

<h1 id="leaks-in-host-discovery">Leaks in Host Discovery</h1>

<p>Since we can only use TCP and DNS within Proxychains, we must disable all other protocols used in Host Discovery phase. According to the Nmap Network Scanning Guide:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Note that if you specify any of the -P options discussed in this section, they *replace* the default discovery probes rather than adding to them.
</code></pre></div></div>

<p>So if we want to skip any UDP or ICMP packets in host discovery and stick only to TCP probes, it should be enough to add the -PS option. This should orverrule all the other ping types.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#proxychains nmap -n -PS -sT 216.58.222.14 -p80 --packet-trace -vv
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.40 ( https://nmap.org ) at 2017-10-17 20:12 -02
Initiating Ping Scan at 20:12
Scanning 216.58.222.14 [1 port]
SENT (0.0689s) TCP 192.168.0.11:48630 &gt; 216.58.222.14:80 S ttl=52 id=6588 iplen=44  seq=630702871 win=1024 &lt;mss 1460&gt;
RCVD (0.2618s) TCP 216.58.222.14:80 &gt; 192.168.0.11:48630 SA ttl=46 id=10400 iplen=44  seq=1872872446 win=42780 &lt;mss 1380&gt;
Completed Ping Scan at 20:12, 0.43s elapsed (1 total hosts)
Initiating Connect Scan at 20:12
Scanning 216.58.222.14 [1 port]
|S-chain|-&lt;&gt;-127.0.0.1:9050-&lt;&gt;&lt;&gt;-216.58.222.14:80-&lt;&gt;&lt;&gt;-OK
CONN (1.0838s) TCP localhost &gt; 216.58.222.14:80 =&gt; Connected
Discovered open port 80/tcp on 216.58.222.14
Completed Connect Scan at 20:12, 0.59s elapsed (1 total ports)
Nmap scan report for 216.58.222.14
Host is up, received syn-ack ttl 46 (0.24s latency).
Scanned at 2017-10-17 20:12:47 -02 for 1s
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1.08 seconds
           Raw packets sent: 1 (44B) | Rcvd: 1 (44B)
</code></pre></div></div>

<p>But no luck this time! In fact, we can check whether our host is probing the target directly:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># tcpdump -vvv host 216.58.222.14
tcpdump: listening on wlp2s0, link-type EN10MB (Ethernet), capture size 262144 bytes
20:12:47.846175 IP (tos 0x0, ttl 52, id 6588, offset 0, flags [none], proto TCP (6), length 44)
    fahrzeug.48630 &gt; gru06s25-in-f14.1e100.net.http: Flags [S], cksum 0x7634 (correct), seq 630702871, win 1024, options [mss 1460], length 0
20:12:48.039067 IP (tos 0x0, ttl 46, id 10400, offset 0, flags [none], proto TCP (6), length 44)
    gru06s25-in-f14.1e100.net.http &gt; fahrzeug.48630: Flags [S.], cksum 0x9fb6 (correct), seq 1872872446, ack 630702872, win 42780, options [mss 1380], length 0
20:12:48.039121 IP (tos 0x0, ttl 64, id 61273, offset 0, flags [DF], proto TCP (6), length 40)
    fahrzeug.48630 &gt; gru06s25-in-f14.1e100.net.http: Flags [R], cksum 0x91ed (correct), seq 630702872, win 0, length 0

3 packets captured
3 packets received by filter
0 packets dropped by kernel
</code></pre></div></div>

<p>Two SYN pings from our host to the target, no proxy. Bad bad OPSEC, folks.</p>

<p>Since proxychains is not tunneling our ping scan, even when we use SYN scan only, how can we avoid leaking our IP during the host discovery phase? Simple: skip it! Make sure the target host is up using some other method and then go for the scanning phase.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># proxychains nmap -n -Pn -sT 216.58.222.14 -p80 --packet-trace -vv
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.40 ( https://nmap.org ) at 2017-10-17 20:13 -02
Initiating Connect Scan at 20:13
Scanning 216.58.222.14 [1 port]
|S-chain|-&lt;&gt;-127.0.0.1:9050-&lt;&gt;&lt;&gt;-216.58.222.14:80-&lt;&gt;&lt;&gt;-OK
CONN (0.7309s) TCP localhost &gt; 216.58.222.14:80 =&gt; Connected
Discovered open port 80/tcp on 216.58.222.14
Completed Connect Scan at 20:13, 0.70s elapsed (1 total ports)
Nmap scan report for 216.58.222.14
Host is up, received user-set (0.70s latency).
Scanned at 2017-10-17 20:13:45 -02 for 1s
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.73 seconds
</code></pre></div></div>

<p>Now our tcpdump result is clean:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># tcpdump -vvv host 216.58.222.14
tcpdump: listening on wlp2s0, link-type EN10MB (Ethernet), capture size 262144 bytes

0 packets captured
0 packets received by filter
0 packets dropped by kernel
</code></pre></div></div>

<p>In conclusion, it is not safe to go through the host discovery phase when using proxychains.</p>

<h1 id="leaks-in-dns-resolution">Leaks in DNS resolution</h1>

<p>This time we are concerned with leaking our IP address through DNS requests. Let’s begin with a simple TCP scan:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># proxychains nmap -Pn -sT -p80 www.google.com -vv
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.40 ( https://nmap.org ) at 2017-10-17 12:36 -02
|DNS-request| www.google.com
|S-chain|-&lt;&gt;-127.0.0.1:9050-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK
|DNS-response| www.google.com is 74.125.29.104
74.125.29.104/0 looks like an IPv6 target specification -- you have to use the -6 option.
Read data files from: /usr/bin/../share/nmap
WARNING: No targets were specified, so 0 hosts scanned.
Nmap done: 0 IP addresses (0 hosts up) scanned in 1.18 seconds
</code></pre></div></div>

<p>The DNS request was correctly made through proxychains, which is using TOR. Strangely, nmap interprets 216.58.214.228/0 as an IPv6 address and then breaks. It seems nmap does not get along with our SOCKS5 DNS resolution.</p>

<p>Let’s see what happens when we scan the IP address directly, instead of the name:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># proxychains nmap -Pn -sT -p80 216.58.222.14 --packet-trace -vv
ProxyChains-3.1 (http://proxychains.sf.net)
                                             
Starting Nmap 7.40 ( https://nmap.org ) at 2017-10-17 12:52 -02
NSOCK INFO [0.0310s] nsock_iod_new2(): nsock_iod_new (IOD #1)
NSOCK INFO [0.0310s] nsock_connect_udp(): UDP connection requested to 8.8.8.8:53 (IOD #1) EID 8
NSOCK INFO [0.0310s] nsock_read(): Read request from IOD #1 [8.8.8.8:53] (timeout: -1ms) EID 18
NSOCK INFO [0.0310s] nsock_iod_new2(): nsock_iod_new (IOD #2)
NSOCK INFO [0.0310s] nsock_connect_udp(): UDP connection requested to 8.8.4.4:53 (IOD #2) EID 24
NSOCK INFO [0.0310s] nsock_read(): Read request from IOD #2 [8.8.4.4:53] (timeout: -1ms) EID 34
NSOCK INFO [0.0310s] nsock_iod_new2(): nsock_iod_new (IOD #3)
NSOCK INFO [0.0310s] nsock_connect_udp(): UDP connection requested to 172.16.100.1:53 (IOD #3) EID 40
NSOCK INFO [0.0310s] nsock_read(): Read request from IOD #3 [172.16.100.1:53] (timeout: -1ms) EID 50
Initiating Parallel DNS resolution of 1 host. at 12:52
NSOCK INFO [0.0310s] nsock_write(): Write request for 44 bytes to IOD #1 EID 59 [8.8.8.8:53]
NSOCK INFO [0.0310s] nsock_trace_handler_callback(): Callback: CONNECT SUCCESS for EID 8 [8.8.8.8:53]
NSOCK INFO [0.0310s] nsock_trace_handler_callback(): Callback: WRITE SUCCESS for EID 59 [8.8.8.8:53]
NSOCK INFO [0.0310s] nsock_trace_handler_callback(): Callback: CONNECT SUCCESS for EID 24 [8.8.4.4:53]
NSOCK INFO [0.0310s] nsock_trace_handler_callback(): Callback: CONNECT SUCCESS for EID 40 [172.16.100.1:53]
NSOCK INFO [0.2920s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 18 [8.8.8.8:53] (125 bytes)
NSOCK INFO [0.2920s] nsock_read(): Read request from IOD #1 [8.8.8.8:53] (timeout: -1ms) EID 66
NSOCK INFO [0.2920s] nsock_iod_delete(): nsock_iod_delete (IOD #1)
NSOCK INFO [0.2920s] nevent_delete(): nevent_delete on event #66 (type READ)
NSOCK INFO [0.2920s] nsock_iod_delete(): nsock_iod_delete (IOD #2)
NSOCK INFO [0.2920s] nevent_delete(): nevent_delete on event #34 (type READ)
NSOCK INFO [0.2920s] nsock_iod_delete(): nsock_iod_delete (IOD #3)
NSOCK INFO [0.2920s] nevent_delete(): nevent_delete on event #50 (type READ)
Completed Parallel DNS resolution of 1 host. at 12:52, 0.26s elapsed
Initiating Connect Scan at 12:52
Scanning gru06s25-in-f14.1e100.net (216.58.222.14) [1 port]
|S-chain|-&lt;&gt;-127.0.0.1:9050-&lt;&gt;&lt;&gt;-216.58.222.14:80-&lt;&gt;&lt;&gt;-OK
CONN (0.9788s) TCP localhost &gt; 216.58.222.14:80 =&gt; Connected
Discovered open port 80/tcp on 216.58.222.14
Completed Connect Scan at 12:52, 0.69s elapsed (1 total ports)
Nmap scan report for gru06s25-in-f14.1e100.net (216.58.222.14)
Host is up, received user-set (0.69s latency).
Scanned at 2017-10-17 12:52:19 -02 for 1s
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack
                                                           
Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.98 seconds
</code></pre></div></div>

<p>As you can see, a reverse DNS resolution to Google’s DNS server (8.8.8.8) is done without a tunnel. Although we are not leaking our IP directly to the target, it still is being leaked. Confirming with tcpdump:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># tcpdump -vvv host 8.8.8.8 and udp                                                                                                                           
tcpdump: listening on wlp2s0, link-type EN10MB (Ethernet), capture size 262144 bytes
12:52:19.621972 IP (tos 0x0, ttl 64, id 10688, offset 0, flags [DF], proto UDP (17), length 72)
    fahrzeug.57577 &gt; google-public-dns-a.google.com.domain: [udp sum ok] 32419+ PTR? 14.222.58.216.in-addr.arpa. (44)
12:52:19.882782 IP (tos 0x0, ttl 55, id 31896, offset 0, flags [none], proto UDP (17), length 153)
    google-public-dns-a.google.com.domain &gt; fahrzeug.57577: [udp sum ok] 32419 q: PTR? 14.222.58.216.in-addr.arpa. 4/0/0 14.222.58.216.in-addr.arpa. [23h47m25s] PTR gru06s25-in-f14.1e100.net., 14.222.58.216.in-addr.arpa. [23h47m25s] PTR gru06s25-in-f14.1e100.net., 14.222.58.216.in-addr.arpa. [23h47m25s] PTR gru06s25-in-f14.1e100.net., 14.222.58.216.in-addr.arpa. [23h47m25s] PTR gru06s25-in-f14.1e100.net. (125)
</code></pre></div></div>

<p>Due to this situation, it seems wise to use the <strong>-n</strong> option (skip name resolution) when scanning through a proxy.</p>

<h1 id="what-about-other-scan-types">What about other scan types?</h1>

<p>We have been using so far the infamous -sT (SYN scan). In fact, -sS is the default scan when running as <em>root</em>, while -sT is the default scan for unprivileged users. But what about -sS under proxychains?</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># proxychains nmap -Pn -n -sS -p80 216.58.222.14 --packet-trace -vv
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.40 ( https://nmap.org ) at 2017-10-17 12:59 -02
Initiating SYN Stealth Scan at 12:59
Scanning 216.58.222.14 [1 port]
SENT (0.0730s) TCP 172.16.100.250:43067 &gt; 216.58.222.14:80 S ttl=59 id=23061 iplen=44  seq=774587308 win=1024 &lt;mss 1460&gt;
RCVD (0.1134s) TCP 216.58.222.14:80 &gt; 172.16.100.250:43067 SA ttl=55 id=63050 iplen=44  seq=2278336372 win=42780 &lt;mss 1380&gt;
Discovered open port 80/tcp on 216.58.222.14
Completed SYN Stealth Scan at 12:59, 0.22s elapsed (1 total ports)
Nmap scan report for 216.58.222.14
Host is up, received user-set (0.040s latency).
Scanned at 2017-10-17 12:59:19 -02 for 0s
PORT   STATE SERVICE REASON
80/tcp open  http    syn-ack ttl 55

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.28 seconds
           Raw packets sent: 1 (44B) | Rcvd: 1 (44B)
</code></pre></div></div>

<p>And in tcpdump:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># tcpdump -vvv host 216.58.222.14
tcpdump: listening on wlp2s0, link-type EN10MB (Ethernet), capture size 262144 bytes
12:59:19.705036 IP (tos 0x0, ttl 59, id 23061, offset 0, flags [none], proto TCP (6), length 44)
    fahrzeug.43067 &gt; gru06s25-in-f14.1e100.net.http: Flags [S], cksum 0xb26f (correct), seq 774587308, win 1024, options [mss 1460], length 0
12:59:19.745452 IP (tos 0x0, ttl 55, id 63050, offset 0, flags [none], proto TCP (6), length 44)
    gru06s25-in-f14.1e100.net.http &gt; fahrzeug.43067: Flags [S.], cksum 0xe050 (correct), seq 2278336372, ack 774587309, win 42780, options [mss 1380], length 0
12:59:19.745507 IP (tos 0x0, ttl 64, id 3672, offset 0, flags [DF], proto TCP (6), length 40)
    fahrzeug.43067 &gt; gru06s25-in-f14.1e100.net.http: Flags [R], cksum 0xce28 (correct), seq 774587309, win 0, length 0

3 packets captured
3 packets received by filter
0 packets dropped by kernel
</code></pre></div></div>

<p class="center"><img src="https://i.imgflip.com/1xsb2t.jpg" alt="Leaks everywhere meme" /></p>

<p>From what we conclude the safest option from what we have tested so far is:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ proxychains nmap -Pn -n -sT &lt;target IP&gt;
</code></pre></div></div>

<p>That is all for now, folks! Please note this is a first draft and <del>most certainly</del> might contain <del>multiple</del> some mistakes. Please feel free to share your corrections, suggestions and observations.</p>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#pentest-ref">
					pentest <span>(2)</span>
					
				</a></li>
			
		  
		</ul>
		  

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#pentest-ref">
					pentest <span>(1)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#nmap-ref">
					nmap <span>(1)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Nmap Anonymization with Proxychains&via=_mvalle_"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="//www.gravatar.com/avatar/1df7ec002d2e576bae0ee492c97e82b8" class="img-rounded author-image" />
        <h4 class="section-title author-name">Marcos Valle</h4>
        <p class="author-bio">Born to kill bugs. Live by them.</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/ctf/2017/03/29/narnia01.html" title="Narnia 01 (VulnHub)">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/ctf/2017/10/28/hackme-lyrics-app.html" title="Hack.me - Lyrics APP">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



    
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'Bugtree';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>





		<footer>
			<hr/>
			<p>
				&copy; 2018 Marcos Valle with <a href="http://jekyllrb.com/">Jekyll</a>. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-76878173-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76878173-1');
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-9647237236939217",
              enable_page_level_ads: true
                    });
</script>

